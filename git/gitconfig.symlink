[user]
	name = Matt Felten
	email = m@mattfelten.com

[core]
	editor = nano
	excludesfile = ~/.gitignore

[mergetool]
	keepBackup = true
	prompt = false

[color]
	ui = true
	diff = true
	pager = true
	status = auto
	branch = auto
	interactive = auto

[alias]
	## Shorthand
	aa = add -A
	ap = add -p
	co = checkout
	br = branch
	bra = branch -a
	c = commit
	g = grep
	st = status
	ss = status -s

	## Add all and check status
	a = !git add -A && git status

	# Get the current branch name (not so useful in itself, but used in other aliases)
	branch-name = "!git rev-parse --abbrev-ref HEAD"

	## Quick amend without rewording
	ca = commit --amend --no-edit

	## Remove old branches, clean untracked files, clear stash
	cleanup = !git remote prune origin && git gc && git clean -dfx && git stash clear

	## Show a list of commits in a branch with coloring
	ls = log --pretty=format:"%C(yellow)%h\\ %C(cyan)%ad%Cred%d\\ %Creset%s%C(magenta)\\ [%an]" --decorate --date=relative -20

	## Unstage all files and reword commit message
	rw = !git reset && git commit --amend

	## Uncommit last commit. Keep changes
	uc = reset HEAD^

	## Create working commit. Use this like stash but permanent to your branch
	wc = !git add -A && git commit -m 'Working Commit'

    ;; git legit
	switch = !legit switch
	branches = !legit branches
	sprout = !legit sprout
	unpublish = !legit unpublish
	harvest = !legit harvest
	sync = !legit sync
	publish = !legit publish
	graft = !legit graft
	resync = !legit resync

	; `git start <local branch>` automatically tracks origin/master
	; `git start <local branch> <tracked branch>`
	start = "!start() {\
			newbranch=$1;\
			[ -z $newbranch ] && echo \"Specify a branch\" && exit 1;\
			trackedbranch=$2;\
			[ -z $trackedbranch ] && trackedbranch='origin/master';\
			git checkout -b $newbranch --track $trackedbranch;\
	};\
	start"

	; git finish <branch to delete>
	finish = "!finish() {\
			deletebranch=$1;\
			[ -z $deletebranch ] &&\
					deletebranch=$(git for-each-ref --format='%(refname:short)'\
							$(git symbolic-ref HEAD));\
			[[ \"$deletebranch\" == 'master' ]] &&\
					echo \"Can't delete master\" && exit 1;\
			git checkout master &&\
			git pull --rebase &&\
			git branch -D $deletebranch;\
	};\
	finish"

	; git rework [<number_of_commits> | <commit_id>]
	; shorthand alias to rebase
	; git rework 8 -> git rebase -i HEAD~8
	; git rework cfd8327 -> git rebase -i cfd8327^
	rework = "!rework() {\
		commitid=$1;\
		[ -z $commitid ] && exit;\
		{\
			[[ $commitid =~ ^[0-9]{1,2}$ ]] && commitid=\"HEAD~$commitid\";\
		}\
			||\
		commitid=\"$commitid^\";\
		git rebase -i $commitid;\
	};\
	rework"

[credential]
	helper = cache

[push]
	default = simple
[pull]
	rebase = true
[filter "hawser"]
	clean = git hawser clean %f
	smudge = git hawser smudge %f
	required = true
